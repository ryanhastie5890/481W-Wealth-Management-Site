<!DOCTYPE html>
<html lang="en" dir="ltr">
<!--webpage for retirement--> 
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <meta charset="utf-8">
    <title>COSC 481 Project</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="shortcut icon" href="#"> <!-- to remove 404 error favicon.ico not found -->
  </head>
  <body>
    <header>
      <!--Header section of the website-->
      <div class="heading" style="height: 7vh;">
        <a href = "index.html" >Wealth Management System</a>
      <p id="message"></p>
      </div>
      <!--Display user while logged in-->
      <div id="user-info" style="position:absolute; top:10px; right:20px; color:white;"></div>
    </header>
    <!-- menu-->
    <div class="menu">
      <a class= "menu-option" href = "RealEstate.html" style="color: lightgreen;"><i class="bi bi-house"></i>Real Estate</a>
      <a class= "menu-option" href = "Investment.html" ><i class="bi bi-bank"></i>Investment</a>
      <a class= "menu-option" href = "Retirement.html" ><i class="bi bi-sunglasses"></i>Retirement</a>
      <a class= "menu-option" href = "Accounts.html" ><i class="bi bi-file-person"></i>Account</a>
    </div>

    <!--<div id="retirement-investments-message" class="bottom-line"> -->
      <h2 style="text-align: center;">Investment Properties</h2>
      <!--Properties display-->
      <h6  class="heading" id="property-status-msg" style="text-align: center;">You do not have any properties added. Add a property to get started.</h6>
<!--add property button-->
<button id=addPropertyButton onclick="showForm()"  class="btn btn-primary">Add Property</button>
 <div id="retirement-investments-message" class="bottom-line">

<!--<h5>Your Properties: </h5>-->


</div>

    <div id="property_form" style="display:none;">
    <form action="/add-property" method="POST"><!--add property form-->
      <label for="name">Name of Property</label><br><br>
      <input name="name" type="text" required><br><br>

      <label for="description">Description of Property</label><br><br>
      <input name="description" type="text" required><br><br>

      <label for="type">Type of Property</label><br><br>
      <select name="type" required>
        <option value="Apartment">Apartment Complex</option>
        <option value="House">House</option>
        <option value="Land">Land</option>
      </select><br><br>

      <label for="status">Status of Property</label><br><br>
      <select name="status" required>
        <option value="Self Owned">Self Owned</option>
        <option value="Rented Out">Rented Out</option>
        <option value="Selling">Selling</option>
        <option value="Leasing">Leasing</option>
      </select><br><br>

      <label for="occupants">Number of Occupants</label><br><br>
      <input name="occupants" type="number" min="0" value="0"><br><br>
      
      <button type="submit">Add Property</button>
    </form>
    </div>


    
    <!--Income, expenses, lease tracking, notifications.-->

    <script src="./js/session.js">
      fetch('/get-properties', {cache: "no-store"})
       .then(res => {
        if(!res.ok) throw new Error("You are not logged in");
        return res.json();
       })
       .then(property => {
        const display = document.getElementById("propertiesDisplay");

        if(property.length == 0){
            display.innerHTML ="<p>You have not added any property";
            return;
        }
        property.forEach(p =>{
            const div = document.createElement("div");
            div.className ="property-item";

            //populate with data
            div.innerHTML =`
                <h3>Name: ${p.name}</h3><br>
                <p>Description: ${p.description}</p><br>
                <p>Type: ${p.type}</p><br>
                <p>Status: ${p.status}</p><br>
                <p>Occupants: ${p.occupants}</p><br>
                <p>Created: ${new Date(p.created_at).toLocaleDateString()}</p>
                `;

            display.appendChild(div);
        });
       })
       .catch(err =>{
        document.getElementById("propertiesDisplay").innerHTML ="<p>You are not logged in</p>"
       });

       //for toggling on and off the form
       function showForm(){
        document.getElementById("property_form").style.display = "flex";
        document.getElementById("propertiesDisplay").style.display = "none";
       }
       function hideForm(){
        document.getElementById("property_form").style.display = "none";
       }
      
    </script>
  </body>
</html>
